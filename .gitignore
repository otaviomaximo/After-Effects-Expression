function Comma(number,sep) {
  number = '' + Math.round(number);
  if (number.length > 3) {
    var mod = number.length % 3;
    var output = (mod > 0 ? (number.substring(0,mod)) : '');
    for (i=0 ; i < Math.floor(number.length / 3); i++) {
      if ((mod == 0) && (i == 0))
        output += number.substring(mod+ 3 * i, mod + 3 * i + 3);
      else
        output+= sep + number.substring(mod + 3 * i, mod + 3 * i + 3);
    }
    return (output);
  }
  else return number;
}

var num = Math.floor(effect("NNum")("Valor").value)*effect("NNum")("Multiplicador");
var menu = effect("NNum")("Pontos e VÃ­rgulas").value;
var mySep = menu == 3 || menu == 4 ? "," : ".";

switch (menu){
  case 3:
  case 4:
    var mySep = ",";
    break;
  case 5:
    var mySep = "_";
    break;
  case 6:
    var mySep = " ";
    break;
  default:
    mySep = "."
    break;
}
num = Comma(num,mySep);

var v = Math.floor(effect("NNum")("Valor").value)*effect("NNum")("Multiplicador");
var x = Math.floor(effect("NNum")("Decimais").value);
var Dec = effect("NNum")("Ativar Decimais");
var Limp = effect("NNum")("Limpar texto");
var Edit = effect("NNum")("Editar Nome");
var QtdDec = effect("NNum")("Quantidade de decimais");
var n = thisLayer.name = text.sourceText;

	if (Dec == 1)
		[n+num+","+("0"+x).slice(-QtdDec)]
	
else [n+num]
		
	if (Dec == 1 && menu == 2)
		[n+num+"."+("0"+x).slice(-QtdDec)]

	if (Limp == 1)
		[num]
	
	if (Edit == 1 && Limp == 0)
		[num+n]
	
	if (Edit == 1 && Dec == 1)
		[num+","+("0"+x).slice(-QtdDec)+n]
	
	if (Edit == 1 && Dec == 1 && menu == 2)
		[num+"."+("0"+x).slice(-QtdDec)+n]
	
	if  (Dec == 1 && Limp == 1)
		[num+","+("0"+x).slice(-QtdDec)]
	
	if  (Dec == 1 && Limp ==1 && menu == 2)
		[num+"."+("0"+x).slice(-QtdDec)]
	
	if (menu == 8 && Limp == 1)
	    v
	
	if (menu == 8 && Edit == 1)
		v + n
   
    if (menu == 8 && Edit == 0 && Limp == 0)
		n + v
